import sys
import platform
if platform.system() == 'Linux':
    sys.path.append('/allen/programs/braintv/workgroups/nc-ophys/Doug/pbstools')
from pbstools import PythonJob # flake8: noqa: E999

#VisualBehaviorDevelopment - complete dataset as of 11/15/18
lims_ids = [639253368, 639438856, 639769395, 639932228, 644942849, 645035903,
       645086795, 645362806, 646922970, 647108734, 647551128, 647887770,
       648647430, 649118720, 649318212, 661423848, 663771245, 663773621,
       664886336, 665285900, 665286182, 670396087, 671152642, 672185644,
       672584839, 673139359, 673460976, 685744008, 686726085, 692342909,
       692841424, 693272975, 693862238, 695471168, 696136550, 698244621,
       698724265, 700914412, 701325132, 702134928, 702723649, 712178916,
       712860764, 713525580, 714126693, 715161256, 715228642, 715887471,
       715887497, 716327871, 716337289, 716600289, 716602547, 719321260,
       719996589, 720001924, 720793118, 723037901, 723064523, 723748162,
       723750115, 729951441, 730863840, 731936595, 732911072, 733691636,
       736490031, 736927574, 737471012, 745353761, 745637183, 747248249,
       750469573, 751935154, 752966796, 753931104, 754552635, 754566180,
       754943841, 756715598, 758274779, 760003838, 760400119, 760696146,
       760986090, 761861597, 762214438, 762214650, 766779984, 767424894,
       768223868, 768224465, 768225217, 768865460, 768871217, 769514560,
       770094844, 771381093, 771427955, 772131949, 772696884, 772735942,
       773816712, 773843260, 774370025, 774379465, 775011398, 775429615,
       776042634, 756565411]


# #VisBehIntTestDatacube
# lims_ids = [742828015, 742828595, 743160774, 743161105, 744540132, 744540163,
#        744540350, 746257283, 746257362, 746425946, 746425960, 746426152,
#        746445059, 746445153, 746445167, 746445294, 746447351, 747305983,
#        747321339, 747321353, 750535101, 750536682, 750536778, 750846133,
#        750850855, 750852080, 750852098, 753089326, 754045120, 754056568,
#        754064001, 754065714, 754068181, 754068195, 754090999, 754091013,
#        754108308, 754108616, 754108630, 754108824, 754588569, 754588583,
#        754845811, 755001578, 755008064, 755011059, 755014874, 755647750,
#        755647764, 755649776, 755649889, 755650903, 756119038, 756119052,
#        756119239, 756131192, 756812463, 756812477, 756812552, 756813628,
#        757628349, 757628365, 757628501, 757945399, 758312489, 758319777,
#        759036676, 759037388, 759037655, 759276375, 759283774, 759283789,
#        759283945, 759580717, 759580731, 759841294, 760095646, 760095646,
#        760097843, 760097843, 760097857, 760097947, 760097947, 760098070,
#        760098185, 760098363, 760098363, 760598315, 760603437, 760603437,
#        760603451, 760603451, 760604597, 760604597, 760604901, 760604901,
#        760604919, 760604919, 760767168, 760767168, 760767396, 760767396,
#        760767427, 760767427, 760767562, 760767562, 761058425, 761058739,
#        761059374, 761059374, 761059388, 761059388, 761059782, 761607566,
#        761607566, 761867107, 762166213]


# # Mesoscope data as of 1/15
# lims_ids = [804835920, 804835922, 804835924, 804835926, 804835928, 804835930, 804835932, 804835934, #slc17 stim 1
# 792694983, 792694987, 792694996, 792695013, 792695018, 792695021, 792695028, 792695031, #VIP images b
# 791748112, 791748114, 791748116, 791748118, 791748122, 791748124, 791748126, 791748128,] #VIP images a

# #VisualBehavior production as of 1/15/19
# lims_ids = [775614751, 778644591, 787461073, 782675436, 783928214, 783927872, 784482326,
#  787501821, 787498309, 788490510, 788488596, 788489531, 789359614, 790146945,
#  790149413, 790709081, 791119849, 791453282, 791453299, 791980891, 792813858,
#  792812544, 792816531, 792815735, 794381992, 794378505, 795076128, 795075034,
#  795073741, 795952471, 795952488, 795953296, 795948257, 796106850, 796105304,
#  796106321, 796108483, 796105823, 796308505, 796306417, 797257159, 797255551,
#  798403387, 798404219, 798392580, 799366517, 799368904, 799368262, 803736273,
#  805100431, 805784331, 805784313, 806456625, 806456687, 806455766, 806989729,
#  807753318, 807752701, 807752719, 807753334, 807753920, 799357437, 805083924,
#  779335436, 782675457, 791974731, 791979236, 794380439, 795954023, 796306435,
#  796304798, 798400822, 800034837, 800034812, 802649986, 806990245, 808621958,
#  808619526, 808619543, 808621034, 808621015]

# # Mesoscope containers 2/6
lims_ids = [787282617, 787282625, 787282643, 787282662, 787282676, 787282685, 787282699, 787282708,
788325934, 788325938, 788325940, 788325944, 788325946, 788325948, 788325950, 788325953,
790002022, 790002024, 790002026, 790002030, 790002034, 790002038, 790002040, 790002044,
789989571, 789989573, 789989575, 789989578, 789989582, 789989586, 789989590, 789989594,
790261676, 790261687, 790261695, 790261701, 790261711, 790261714, 790261719, 790261723,
791262690, 791262693, 791262695, 791262698, 791262701, 791262705, 791262708, 791262710,
791748112, 791748114, 791748116, 791748118, 791748122, 791748124, 791748126, 791748128,
792694983, 792694987, 792694996, 792695013, 792695018, 792695021, 792695028, 792695031]


python_file = r"/home/marinag/visual_behavior_analysis/scripts/create_analysis_files.py"

jobdir = '/allen/programs/braintv/workgroups/nc-ophys/Marina/ClusterJobs/JobRecords2'

job_settings = {'queue': 'braintv',
                'mem': '60g',
                'walltime': '8:00:00',
                'ppn': 1,
                'jobdir': jobdir,
                }

for lims_id in lims_ids:
    print(lims_id)
    PythonJob(
        python_file,
        python_executable='/home/marinag/anaconda2/envs/visual_behavior_ophys/bin/python',
        python_args=lims_id,
        conda_env=None,
        jobname='process_{}'.format(lims_id),
        **job_settings
    ).run(dryrun=False)
